/* map-tools.js 2.0.2 MIT License. 2019 Yago Ferrer <yago.ferrer@gmail.com> */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r;r="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,r.mapTools=t()}}(function(){var t;return function t(r,n,e){function o(a,s){if(!n[a]){if(!r[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var c=n[a]={exports:{}};r[a][0].call(c.exports,function(t){var n=r[a][1][t];return o(n||t)},c,c.exports,t,r,n,e)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<e.length;a++)o(e[a]);return o}({1:[function(t,r,n){var e=t("topojson"),o=t("./utils"),i=t("./addFilter"),a=function(){function t(t){this.that=t;var r=new i(t,"json");this.addFilter=function(t){return r.addFilter(t)}}return t.prototype.addFeatureOptions=function(t,r){var n,e;for(e in t)if(t.hasOwnProperty(e)){n=t[e];var i=o.createUid();n.uid=i,n.data={uid:i},n.forEachProperty(function(t,r){n.data[r]=t}),r&&(r.filters&&(this.that.json.filter||this.addFilter(r.filters),this.that.json.crossfilter.add([n])),r.style&&this.that.instance.data.overrideStyle(n,r.style)),this.that.json.all[n.data.uid]=n}},t.prototype.addTopoJson=function(t,r){var n,o,i,a;for(a in r)r.hasOwnProperty(a)&&(n=r[a],o=e.feature(t,t.objects[n.object]),i=this.that.instance.data.addGeoJson(o),this.addFeatureOptions(i,n),mapTools.maps[this.that.id].json.all[n.object]=i);return i},t.prototype.addGeoJson=function(t,r){var n=this.that.instance.data.addGeoJson(t,r);return this.addFeatureOptions(n,r),n},t}();r.exports=a},{"./addFilter":2,"./utils":20,topojson:23}],2:[function(t,r,n){var e=t("./utils"),o=function(){function t(t,r){this.that=t,this.type=r}return t.prototype.addFilter=function(t){this.that[this.type].crossfilter=this.that[this.type].crossfilter||this.that.crossfilter([]),this.that[this.type].filter=this.that[this.type].filter||{};var r,n;"string"==typeof t&&(t=[t]);for(r in t)t.hasOwnProperty(r)&&(n=t[r],"string"==typeof n?this.that[this.type].filter[n]=this.that[this.type].crossfilter.dimension(e.defaultDimension(n)):this.that[this.type].filter[Object.keys(n)[0]]=this.that[this.type].crossfilter.dimension(n[Object.keys(n)[0]]))},t}();r.exports=o},{"./utils":20}],3:[function(t,r,n){var e=t("./maps"),o=t("./config"),i=function(){function t(t){this.that=t}return t.prototype.getElement=function(t){return t.el?window.document.querySelector(t.el):t.id?window.document.getElementById(t.id):void 0},t.prototype.create=function(t,r){var n=this;r=r||function(){};var i=e.mapOptions(t);if(t.id=t.id||t.el.substring(1),this.that.id=t.id,this.that.options=t,this.that.instance=new google.maps.Map(this.getElement(t),i),this.that.events=[],t.on){var a;for(a in t.on)t.on.hasOwnProperty(a)&&(o.customEvents.indexOf(a)>-1&&this.that.events.push(a),google.maps.event.addListener(this.that.instance,a,t.on[a]))}this.that.infoWindow=!1,this.that.templates={infoWindow:{},panel:{}},this.that.uid=t.uid,mapTools.maps[this.that.id].instance=this.that.instance,google.maps.event.addListenerOnce(this.that.instance,"idle",function(){r(!1,n.that)})},t.prototype.validOptions=function(t,r){return!t||t&&"object"!=typeof t?(r(new Error("You must pass a valid first parameter: options")),!1):t.id||t.el?!(!t.lat||!t.lng)||(r(new Error('You must pass valid "lat" (latitude) and "lng" (longitude) values')),!1):(r(new Error('You must pass an "id" or a "el" property values')),!1)},t.prototype.load=function(t,r){if(this.validOptions(t,r)){var n=t.id||t.el.substring(1);if(mapTools.maps=mapTools.maps||{},mapTools.maps[n]){var o="There is already another Map using the same id: "+n;return r(new Error(o)),!1}var i=this;mapTools.maps[n]={create:function(){i.create(this.arguments,r)},arguments:t},mapTools.maps[n].markers=mapTools.maps[n].markers||{all:{},tags:{},dataChanged:!1},mapTools.maps[n].json=mapTools.maps[n].json||{all:{},dataChanged:!1},this.that.markers=mapTools.maps[n].markers,this.that.json=mapTools.maps[n].json,!1!==t.async||!0===t.sync?e.load(n,t):mapTools.maps[n].create()}},t}();r.exports=i},{"./config":7,"./maps":13}],4:[function(t,r,n){var e=t("./utils"),o=t("./addFilter"),i=t("./infoWindow"),a=function(){function t(t){this.that=t,this.infoWindow={};var r=new o(t,"markers");this.addFilter=function(t){return r.addFilter(t)};var n=new i(t);this.infoWindow.addEvents=function(t,r,e){n.addEvents(t,r,e)}}return t.prototype.addExtraOptions=function(t,r){var n;for(n in r)r.hasOwnProperty(n)&&(r.filters||(t[n]=r[n]))},t.prototype.addOptions=function(t,r){t.move&&r.setAnimation(google.maps.Animation[t.move.toUpperCase()]),t.infoWindow&&this.infoWindow.addEvents(r,t.infoWindow,this.that.instance),t.on&&this.addEvents(t,r),t.callback&&t.callback(r)},t.prototype._addMarker=function(t,r){if(t.map=this.that.instance,t.position=new google.maps.LatLng(t.lat,t.lng),r&&this.addExtraOptions(t,r),t.data=t.data||{},t.data._self=t,this.setUid(t),this.that.markers.all[t.uid])return!1;r&&r.filters&&(mapTools.maps[this.that.id].markers.filter||this.addFilter(r.filters));var n=new google.maps.Marker(t);return this.that.markers.crossfilter=this.that.markers.crossfilter||this.that.crossfilter([]),this.that.markers.filter=this.that.markers.filter||{},this.that.markers.crossfilter.add([n]),this.addOptions(t,n),this.that.markers.all=mapTools.maps[this.that.id].markers.all||{},this.that.markers.all[t.uid]=n,t.tags&&this.addMarkerByTag(t,n),n},t.prototype.setUid=function(t){this.that.uid&&t[this.that.uid]&&(t.data.uid=t[this.that.uid],t.uid=t.data.uid),t.data.uid&&!t.uid&&(t.uid=t.data.uid),t.uid||(t.data.uid=e.createUid(),t.uid=t.data.uid)},t.prototype.addMarkerByTag=function(t,r){if(e.isArray(t.tags)){var n,o;for(n in t.tags)t.tags.hasOwnProperty(n)&&(o=t.tags[n],this.that.markers.tags[o]=this.that.markers.tags[o]||{},this.that.markers.tags[o][r.data.uid]=r)}else this.that.markers.tags[t.tags]=this.that.markers.tags[t.tags]||{},this.that.markers.tags[t.tags][r.data.uid]=r},t.prototype.addEvents=function(t,r){var n;for(n in t.on)t.on.hasOwnProperty(n)&&google.maps.event.addListener(r,n,t.on[n])},t.prototype.addMarker=function(t,r){if(e.isArray(t)){if(t.length>=1){var n,o=[];for(var i in t)t.hasOwnProperty(i)&&(n=this._addMarker(t[i],r),o.push(n));return this.that.markers.dataChanged=!0,o}return[]}return this.that.markers.dataChanged=!0,this._addMarker(t,r)},t}();r.exports=a},{"./addFilter":2,"./infoWindow":10,"./utils":20}],5:[function(t,r,n){var e=t("./config"),o=t("./template"),i=function(){function t(t){this.that=t;var r=new o(t);this.template=function(t,n,e){return r.load(t,n,e)}}return t.prototype.getPositionKey=function(t){return t.toUpperCase().match(/\S+/g).join("_")},t.prototype.hy2cmml=function(t){return t.replace(/-(.)/g,function(t,r){return r.toUpperCase()})},t.prototype.HTMLParser=function(t){var r=window.document.createElement("div");return r.innerHTML=t,r},t.prototype.onSuccess=function(t,r,n,e){var o,i;if(t.position&&(t.position=this.getPositionKey(t.position),r=google.maps.ControlPosition[t.position]),"object"==typeof t.style)for(i in t.style)if(t.style.hasOwnProperty(i)){var a=this.hy2cmml(i);n.style[a]=t.style[i]}if(t.events)for(o in t.events)if(t.events.hasOwnProperty(o)){var s=o.match(/\S+/g),u=s.splice(-1),f=s.join(" "),c=n.querySelectorAll(f);[].forEach.call(c,function(r){google.maps.event.addDomListener(r,u,t.events[o])})}this.that.instance.controls[r].push(n),this.that.panels=this.that.panels||{},this.that.panels[r]=n,e(!1,n)},t.prototype.addPanel=function(t,r){var n=this;r=r||function(){};var o;t.position=t.position||e.panelPosition,t.templateURL?this.template("panel",t.templateURL,function(e,i){return e?(r(e),!1):(o=n.HTMLParser(i),n.onSuccess(t,void 0,o,r))}):(o="string"==typeof t.template?this.HTMLParser(t.template):t.template,this.onSuccess(t,void 0,o,r))},t}();r.exports=i},{"./config":7,"./template":16}],6:[function(t,r,n){var e=function(){function t(){}return t.prototype.pos=function(t,r){var n;n=t&&r?new google.maps.LatLng(t,r):new google.maps.LatLng(this.options.lat,this.options.lng),this.instance.setCenter(n)},t}();r.exports=e},{}],7:[function(t,r,n){var e=function(){function t(){}return t.version="3.39",t.url="//maps.googleapis.com/maps/api/js",t.zoom=8,t.customMapOptions=["id","lat","lng","type","uid"],t.customMarkerOptions=["lat","lng","move","infoWindow","on","callback","tags"],t.panelPosition="TOP_LEFT",t.customInfoWindowOptions=["open","close"],t.customEvents=["marker_visibility_changed"],t}();r.exports=e},{}],8:[function(t,r,n){var e=t("./addFilter"),o=function(){function r(r,n){this.that=r,this.type=n,this.orderLookup={ASC:"top",DESC:"bottom"},this.utils=t("./utils");var o=new e(r,n);this.addFilter=function(t){return o.addFilter(t)}}return r.prototype.clearAll=function(t){var r,n;for(r in t)t.hasOwnProperty(r)&&(n=t[r],!0===this.that[this.type].dataChanged?(n.dispose(),this.addFilter(r)):n.filterAll())},r.prototype.filterByTag=function(t){if(this.utils.isArray(t)&&1===t.length&&(t=t[0]),"string"==typeof t)return this.that[this.type].tags[t]?this.utils.toArray(this.that[this.type].tags[t]):[];var r=this.fetchByTag(t);return"object"==typeof r&&(r=this.utils.toArray(r)),r},r.prototype.fetchByTag=function(t){var r,n;for(n=0;n<t.length-1;n++){var e=t[n],o=t[n+1];r=this.utils.getCommonObject(this.that[this.type].tags[e],this.that[this.type].tags[o])}return r},r.prototype.filter=function(t,r){if(void 0===t&&void 0===r)return this.utils.toArray(this.that[this.type].all);var n,e,o,i;if("string"==typeof t)n=t;else if(n=Object.keys(t)[0],i=t[n],"tags"===n)return this.filterByTag(i);this.clearAll(this.that[this.type].filter),this.that[this.type].filter[n]||this.addFilter(n),e=r&&r.order&&this.orderLookup[r.order]?this.orderLookup[r.order]:this.orderLookup[Object.keys(this.orderLookup)[0]],o=r&&r.limit?r.limit:1/0,void 0===i&&(i=null);var a=this.that[this.type].filter[n].filter(i)[e](o);return this.that[this.type].dataChanged=!1,1===o?a[0]:a},r}();r.exports=o},{"./addFilter":2,"./utils":20}],9:[function(t,r,n){var e=function(){function t(t){this.that=t}return t.prototype.find=function(t){return t.data&&t.data.uid?t:t.uid&&mapTools.maps[this.that.id].markers.all[t.uid]?mapTools.maps[this.that.id].markers.all[t.uid]:void 0},t}();r.exports=e},{}],10:[function(t,r,n){var e=function(){function r(r){this.that=r,this.utils=t("./utils"),this.config=t("./config")}return r.prototype.infoWindow=function(t,r,n){var e=!1;r.infoWindow.content&&(r.infoWindow.content.indexOf("{")>-1&&(e=n.content.replace(/\{(\w+)\}/g,function(t,n){return r.data[n]||""})),e=e||r.infoWindow.content);var o=this.utils.clone(n);o.content=e,this.that.infoWindow=new google.maps.InfoWindow(o),this.that.infoWindow.open(t,r)},r.prototype.open=function(t,r,n){this.close(),this.infoWindow(t,r,n)},r.prototype.isOpen=function(t){var r=t.getMap();return null!==r&&void 0!==r},r.prototype.close=function(){clearTimeout(this.timer),this.that.infoWindow&&this.isOpen(this.that.infoWindow)&&this.that.infoWindow.close()},r.prototype.addEvents=function(t,r,n){var e=this,o=this.utils.prepareOptions(r,this.config.customInfoWindowOptions),i=o.custom&&o.custom.open&&o.custom.open.on?o.custom.open.on:"click",a=o.custom&&o.custom.close&&o.custom.close.on?o.custom.close.on:"click";i===a?google.maps.event.addListener(t,i,function(){e.that.infoWindow&&e.isOpen(e.that.infoWindow)?e.close():e.open(n,t,o.defaults)}):(google.maps.event.addListener(t,i,function(){e.open(n,t,o.defaults)}),google.maps.event.addListener(t,a,function(){o.custom.close.duration?e.timer=setTimeout(function(){e.close()},o.custom.close.duration):e.close()}))},r}();r.exports=e},{"./config":7,"./utils":20}],11:[function(t,r,n){var e=function(){function t(){}return t.prototype.locate=function(){var t=this.instance.getCenter();return{lat:t.lat(),lng:t.lng()}},t}();r.exports=e},{}],12:[function(t,r,n){var e=t("./addMarker"),o=t("./addFeature"),i=t("./addPanel"),a=t("./center"),s=t("./locate"),u=t("./updateMarker"),f=t("./updateMap"),c=t("./updateFeature"),l=t("./addMap"),p=t("./removeMarker"),h=t("./resetMarker"),d=t("./filter"),v=function(){function r(r,n){this.crossfilter=t("crossfilter");var v=new e(this);this.addMarker=function(t,r){return v.addMarker(t,r)};var y=new o(this);this.addTopoJson=function(t,r){return y.addTopoJson(t,r)},this.addGeoJson=function(t,r){return y.addGeoJson(t,r)};var g=new i(this);this.addPanel=function(t,r){return g.addPanel(t,r)},this.center=(new a).pos,this.locate=(new s).locate;var m=new u(this);this.updateMarker=function(t,r){return m.update(t,r)};var b=new f(this);this.updateMap=function(t){b.updateMap(t)};var k=new c(this);this.updateFeature=function(t,r){return k.update(t,r)};var w=new p(this);this.removeMarker=function(t){return w.removeMarker(t)};var M=new h(this);this.resetMarker=function(t,r){return M.resetMarker(t,r)};var x=new d(this,"markers");this.findMarker=function(t,r){return x.filter(t,r)};var O=new d(this,"json");this.findFeature=function(t,r){return O.filter(t,r)},new l(this).load(r,n)}return r.prototype.zoom=function(t){if(void 0===t)return this.instance.getZoom();this.instance.setZoom(t)},r}();r.exports=v},{"./addFeature":1,"./addMap":3,"./addMarker":4,"./addPanel":5,"./center":6,"./filter":8,"./locate":11,"./removeMarker":14,"./resetMarker":15,"./updateFeature":17,"./updateMap":18,"./updateMarker":19,crossfilter:22}],13:[function(t,r,n){var e=t("./utils"),o=t("./config"),i=function(){function t(){}return t.load=function(t,r){var n=r.version||o.version,e=window.document.createElement("script");return e.type="text/javascript",e.src=o.url+"?v="+n+"&key="+r.key+"&callback=mapTools.maps."+t+".create",window.document.body.appendChild(e)},t.mapOptions=function(t){var r=e.clone(t,o.customMapOptions);return r.zoom=t.zoom||o.zoom,t.lat&&t.lng&&(r.center=new google.maps.LatLng(t.lat,t.lng)),t.type&&(r.mapTypeId=google.maps.MapTypeId[t.type]||!1),r},t}();r.exports=i},{"./config":7,"./utils":20}],14:[function(t,r,n){var e=t("./findMarkerById"),o=function(){function t(t){this.that=t;var r=new e(t);this.findMarker=function(t){return r.find(t)}}return t.prototype.removeBulk=function(t){var r,n;for(n in t)t.hasOwnProperty(n)&&(r=t[n],this.remove(this.findMarker(r)))},t.prototype.removeMarker=function(t){void 0===t&&this.removeBulk(this.that.markers.all);var r=Object.prototype.toString.call(t);if("[object Object]"===r)return this.remove(this.findMarker(t));"[object Array]"===r&&this.removeBulk(t)},t.prototype.remove=function(t){t.setMap(null),delete mapTools.maps[this.that.id].markers.all[t.data.uid]},t}();r.exports=o},{"./findMarkerById":9}],15:[function(t,r,n){var e=t("./utils"),o=t("./config"),i=t("./findMarkerById"),a=t("./updateMarker"),s=function(){function t(t){this.that=t;var r=new i(t);this.findMarker=function(t){return r.find(t)},this.updateMarker=new a(t)}return t.prototype.resetBulk=function(t,r){var n;for(n in t)t.hasOwnProperty(n)&&this.reset(t[n],r)},t.prototype.resetMarker=function(t,r){var n,e=Object.prototype.toString.call(t);return"[object Object]"===e&&(n=this.reset(this.findMarker(t),r)),"[object Array]"===e&&(n=this.resetBulk(t,r)),this.that.markers.dataChanged=!0,n},t.prototype.formatOptions=function(t,r){var n,e={},o=Object.prototype.toString.call(r);if("[object String]"===o&&(e[r]=t.data._self[r]),"[object Array]"===o)for(n in r)r.hasOwnProperty(n)&&(e[r[n]]=t.data._self[r[n]]);return e},t.prototype.reset=function(t,r){var n=e.prepareOptions(this.formatOptions(t,r),o.customMarkerOptions);return this.updateMarker.customUpdate(t,n),t},t}();r.exports=s},{"./config":7,"./findMarkerById":9,"./updateMarker":19,"./utils":20}],16:[function(t,r,n){var e=function(){function t(t){this.that=t}return t.prototype.load=function(t,r,n){var e=this;if(this.that.templates[t][r])return this.that.templates[t][r];var o=new XMLHttpRequest;o.open("GET",r),o.onload=function(){4===o.readyState&&(200===o.status?(e.that.templates[t][r]=o.responseText,n(!1,o.responseText)):n(new Error(o.statusText)))},o.send(null)},t}();r.exports=e},{}],17:[function(t,r,n){var e=function(){function t(t){this.that=t}return t.prototype.updateStyle=function(t,r){if("function"==typeof r){var n=r.call(t);return this.that.instance.data.overrideStyle(t,n)}this.that.instance.data.overrideStyle(t,r)},t.prototype.findAndUpdate=function(t,r){return t.data&&t.data.uid?this.updateFeature(t,r):t.uid&&mapTools.maps[this.that.id].json&&mapTools.maps[this.that.id].json.all[t.uid]?this.updateFeature(mapTools.maps[this.that.id].json.all[t.uid],r):void 0},t.prototype.update=function(t,r){var n=Object.prototype.toString.call(t);if("[object Array]"===n){var e,o;for(o in t)t.hasOwnProperty(o)&&(e=t[o],this.findAndUpdate(e,r))}"[object Object]"===n&&this.findAndUpdate(t,r)},t.prototype.updateFeature=function(t,r){r.style&&this.updateStyle(t,r.style)},t}();r.exports=e},{}],18:[function(t,r,n){var e=t("./maps"),o=function(){function t(t){this.that=t}return t.prototype.updateMap=function(t){var r=e.mapOptions(t);return this.that.instance.setOptions(r)},t}();r.exports=o},{"./maps":13}],19:[function(t,r,n){var e=t("./utils"),o=t("./config"),i=t("./findMarkerById"),a=t("./filter"),s=function(){function t(t){this.that=t;var r=new i(t);this.findMarker=function(t){return r.find(t)}}return t.prototype.removeTags=function(t){if(e.isArray(t.tags)){var r,n;for(r in t.tags)t.tags.hasOwnProperty(r)&&(n=t.tags[r],delete this.that.markers.tags[n][t.data.uid])}else delete this.that.markers.tags[t.tags][t.data.uid]},t.prototype.addTags=function(t,r){if(e.isArray(r.custom.tags)){var n,o;for(n in r.custom.tags)o=r.custom.tags[n],this.that.markers.tags[o]=this.that.markers.tags[o]||{},this.that.markers.tags[o][t.data.uid]=t}else this.that.markers.tags[r.custom.tags]=this.that.markers.tags[r.custom.tags]||{},this.that.markers.tags[r.custom.tags][t.data.uid]=t;t.tags=r.custom.tags},t.prototype.updateTag=function(t,r){this.removeTags(t),this.addTags(t,r)},t.prototype.customUpdate=function(t,r){return r.custom&&(r.custom.move&&t.setAnimation(google.maps.Animation[r.custom.move.toUpperCase()]),r.custom.lat&&r.custom.lng&&t.setPosition(new google.maps.LatLng(r.custom.lat,r.custom.lng)),r.custom.infoWindow&&r.custom.infoWindow.content&&(t.infoWindow.content=r.custom.infoWindow.content),r.custom.tags&&this.updateTag(t,r)),r.defaults&&t.setOptions(r.defaults),t},t.prototype.bulkUpdate=function(t,r){var n,e,o,i=[];for(o in t)t.hasOwnProperty(o)&&(n=t[o],e=this.customUpdate(this.findMarker(n),r),i.push(e));return i},t.prototype.countVisible=function(){var t,r=0;for(t in this.that.markers.all)this.that.markers.all[t].visible&&r++;google.maps.event.trigger(this.that.instance,"marker_visibility_changed",r)},t.prototype.update=function(t,r){var n=!1,i=e.prepareOptions(r,o.customMarkerOptions);i.defaults&&i.defaults.hasOwnProperty("visible")&&this.that.events.indexOf("marker_visibility_changed")>-1&&(n=!0);var s,u=Object.prototype.toString.call(t);if("[object Object]"===u)if(1===Object.keys(t).length&&t.tags){var f=new a(this.that,"markers");s=this.bulkUpdate(f.filter(t),i)}else s=this.customUpdate(this.findMarker(t),i);return"[object Array]"===u&&(s=this.bulkUpdate(t,i)),n&&this.countVisible(),this.that.markers.dataChanged=!0,s},t}();r.exports=s},{"./config":7,"./filter":8,"./findMarkerById":9,"./utils":20}],20:[function(t,r,n){var e=function(){function t(){}return t.clone=function(t,r){var n,e,o;n=Array.isArray(t)?[]:{};for(o in t)t.hasOwnProperty(o)&&(!r||r&&-1===r.indexOf(o))&&(e=t[o],n[o]="object"==typeof e?this.clone(e):e);return n},t.createUid=function(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var r,n;return r=16*Math.random()|0,n="x"===t?r:3&r|8,n.toString(16)})},t.prepareOptions=function(t,r){var n,e={custom:{},defaults:{}};for(n in t)t.hasOwnProperty(n)&&(r.indexOf(n)>-1?(e.custom=e.custom||{},e.custom[n]=t[n]):(e.defaults=e.defaults||{},e.defaults[n]=t[n]));return e},t.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},t.toArray=function(t){return Object.keys(t).map(function(r){return t[r]})},t.defaultDimension=function(t){return function(r){return void 0===r.data[t]&&void 0!==r[t]?r[t]:void 0===r.data[t]&&void 0===r[t]?null:r.data[t]}},t.getCommonObject=function(t,r){var n={};for(var e in t)if(t.hasOwnProperty(e)){var o=r[e];void 0!==o&&(n[e]=o)}return n},t}();r.exports=e},{}],21:[function(t,r,n){!function(t){function r(t){return t}function n(t,r){for(var n=0,e=r.length,o=new Array(e);n<e;++n)o[n]=t[r[n]];return o}function e(t){function r(r,n,e,o){for(;e<o;){var i=e+o>>>1;t(r[i])<n?e=i+1:o=i}return e}function n(r,n,e,o){for(;e<o;){var i=e+o>>>1;n<t(r[i])?o=i:e=i+1}return e}return n.right=n,n.left=r,n}function o(t){function r(t,r,n){for(var o=n-r,i=1+(o>>>1);--i>0;)e(t,i,o,r);return t}function n(t,r,n){for(var o,i=n-r;--i>0;)o=t[r],t[r]=t[r+i],t[r+i]=o,e(t,1,i,r);return t}function e(r,n,e,o){for(var i,a=r[--o+n],s=t(a);(i=n<<1)<=e&&(i<e&&t(r[o+i])>t(r[o+i+1])&&i++,!(s<=t(r[o+i])));)r[o+n]=r[o+i],n=i;r[o+n]=a}return r.sort=n,r}function i(t){function r(r,e,o,i){var a,s,u,f=new Array(i=Math.min(o-e,i));for(s=0;s<i;++s)f[s]=r[e++];if(n(f,0,i),e<o){a=t(f[0]);do{t(u=r[e])>a&&(f[0]=u,a=t(n(f,0,i)[0]))}while(++e<o)}return f}var n=o(t);return r}function a(t){function r(r,n,e){for(var o=n+1;o<e;++o){for(var i=o,a=r[o],s=t(a);i>n&&t(r[i-1])>s;--i)r[i]=r[i-1];r[i]=a}return r}return r}function s(t){function r(t,r,o){return(o-r<j?e:n)(t,r,o)}function n(n,e,o){var i,a=(o-e)/6|0,s=e+a,u=o-1-a,f=e+o-1>>1,c=f-a,l=f+a,p=n[s],h=t(p),d=n[c],v=t(d),y=n[f],g=t(y),m=n[l],b=t(m),k=n[u],w=t(k);h>v&&(i=p,p=d,d=i,i=h,h=v,v=i),b>w&&(i=m,m=k,k=i,i=b,b=w,w=i),h>g&&(i=p,p=y,y=i,i=h,h=g,g=i),v>g&&(i=d,d=y,y=i,i=v,v=g,g=i),h>b&&(i=p,p=m,m=i,i=h,h=b,b=i),g>b&&(i=y,y=m,m=i,i=g,g=b,b=i),v>w&&(i=d,d=k,k=i,i=v,v=w,w=i),v>g&&(i=d,d=y,y=i,i=v,v=g,g=i),b>w&&(i=m,m=k,k=i,i=b,b=w,w=i);var M=d,x=v,O=m,j=b;n[s]=p,n[c]=n[e],n[f]=y,n[l]=n[o-1],n[u]=k;var E=e+1,P=o-2,A=x<=j&&x>=j;if(A)for(var T=E;T<=P;++T){var L=n[T],S=t(L);if(S<x)T!==E&&(n[T]=n[E],n[E]=L),++E;else if(S>x)for(;;){var C=t(n[P]);{if(!(C>x)){if(C<x){n[T]=n[E],n[E++]=n[P],n[P--]=L;break}n[T]=n[P],n[P--]=L;break}P--}}}else for(var T=E;T<=P;T++){var L=n[T],S=t(L);if(S<x)T!==E&&(n[T]=n[E],n[E]=L),++E;else if(S>j)for(;;){var C=t(n[P]);{if(!(C>j)){C<x?(n[T]=n[E],n[E++]=n[P],n[P--]=L):(n[T]=n[P],n[P--]=L);break}if(--P<T)break}}}if(n[e]=n[E-1],n[E-1]=M,n[o-1]=n[P+1],n[P+1]=O,r(n,e,E-1),r(n,P+2,o),A)return n;if(E<s&&P>u){for(var F,C;(F=t(n[E]))<=x&&F>=x;)++E;for(;(C=t(n[P]))<=j&&C>=j;)--P;for(var T=E;T<=P;T++){var L=n[T],S=t(L);if(S<=x&&S>=x)T!==E&&(n[T]=n[E],n[E]=L),E++;else if(S<=j&&S>=j)for(;;){var C=t(n[P]);{if(!(C<=j&&C>=j)){C<x?(n[T]=n[E],n[E++]=n[P],n[P--]=L):(n[T]=n[P],n[P--]=L);break}if(--P<T)break}}}}return r(n,E,P+1)}var e=a(t);return r}function u(t){for(var r=new Array(t),n=-1;++n<t;)r[n]=0;return r}function f(t,r){for(var n=t.length;n<r;)t[n++]=0;return t}function c(t,r){if(r>32)throw new Error("invalid array width!");return t}function l(t,r){return function(n){var e=n.length;return[t.left(n,r,0,e),t.right(n,r,0,e)]}}function p(t,r){var n=r[0],e=r[1];return function(r){var o=r.length;return[t.left(r,n,0,o),t.left(r,e,0,o)]}}function h(t){return[0,t.length]}function d(){return null}function v(){return 0}function y(t){return t+1}function g(t){return t-1}function m(t){return function(r,n){return r+ +t(n)}}function b(t){return function(r,n){return r-t(n)}}function k(){function t(t){var r=j,n=t.length;return n&&(k=k.concat(t),S=T(S,j+=n),F.forEach(function(e){e(t,r,n)})),c}function e(){for(var t=w(j,j),r=[],n=0,e=0;n<j;++n)S[n]?t[n]=e++:r.push(n);C.forEach(function(t){t(0,[],r)}),_.forEach(function(r){r(t)});for(var o,n=0,e=0;n<j;++n)(o=S[n])&&(n!==e&&(S[e]=o,k[e]=k[n]),++e);for(k.length=e;j>e;)S[--j]=0}function a(t){function e(r,e,o){H=r.map(t),V=Q(M(o),0,o),H=n(H,V);var i,a=$(H),s=a[0],u=a[1];if(Y)for(i=0;i<o;++i)Y(H[i],i)||(S[V[i]+e]|=Z);else{for(i=0;i<s;++i)S[V[i]+e]|=Z;for(i=u;i<o;++i)S[V[i]+e]|=Z}if(!e)return D=H,R=V,nt=s,void(et=u);var f=D,c=R,l=0,p=0;for(D=new Array(j),R=w(j,j),i=0;l<e&&p<o;++i)f[l]<H[p]?(D[i]=f[l],R[i]=c[l++]):(D[i]=H[p],R[i]=V[p++]+e);for(;l<e;++l,++i)D[i]=f[l],R[i]=c[l];for(;p<o;++p,++i)D[i]=H[p],R[i]=V[p]+e;a=$(D),nt=a[0],et=a[1]}function a(t,r,n){tt.forEach(function(t){t(H,V,r,n)}),H=V=null}function u(t){for(var r,n=0,e=0;n<j;++n)S[r=R[n]]&&(n!==e&&(D[e]=D[n]),R[e]=t[r],++e);for(D.length=e;e<j;)R[e++]=0;var o=$(D);nt=o[0],et=o[1]}function f(t){var r=t[0],n=t[1];if(Y)return Y=null,I(function(t,e){return r<=e&&e<n}),nt=r,et=n,K;var e,o,i,a=[],s=[];if(r<nt)for(e=r,o=Math.min(nt,n);e<o;++e)S[i=R[e]]^=Z,a.push(i);else if(r>nt)for(e=nt,o=Math.min(r,et);e<o;++e)S[i=R[e]]^=Z,s.push(i);if(n>et)for(e=Math.max(r,et),o=n;e<o;++e)S[i=R[e]]^=Z,a.push(i);else if(n<et)for(e=Math.max(nt,n),o=et;e<o;++e)S[i=R[e]]^=Z,s.push(i);return nt=r,et=n,C.forEach(function(t){t(Z,a,s)}),K}function c(t){return null==t?U():Array.isArray(t)?W(t):"function"==typeof t?G(t):E(t)}function E(t){return f(($=l(O,t))(D))}function W(t){return f(($=p(O,t))(D))}function U(){return f(($=h)(D))}function G(t){return $=h,I(Y=t),nt=0,et=j,K}function I(t){var r,n,e,o=[],i=[];for(r=0;r<j;++r)!(S[n=R[r]]&Z)^!!(e=t(D[r],r))&&(e?(S[n]&=X,o.push(n)):(S[n]|=Z,i.push(n)));C.forEach(function(t){t(Z,o,i)})}function B(t){for(var r,n=[],e=et;--e>=nt&&t>0;)S[r=R[e]]||(n.push(k[r]),--t);return n}function q(t){for(var r,n=[],e=nt;e<et&&t>0;)S[r=R[e]]||(n.push(k[r]),--t),e++;return n}function N(t){function n(r,n,e,o){function i(){++H===J&&(m=L(m,z<<=1),U=L(U,z),J=x(z))}var c,l,p,h,v,y,g=W,m=w(H,J),b=B,M=N,O=H,E=0,P=0;for(K&&(b=M=d),W=new Array(H),H=0,U=O>1?T(U,j):w(j,J),O&&(p=(l=g[0]).key);P<o&&!((h=t(r[P]))>=h);)++P;for(;P<o;){for(l&&p<=h?(v=l,y=p,m[E]=H,(l=g[++E])&&(p=l.key)):(v={key:h,value:M()},y=h),W[H]=v;!(h>y||(U[c=n[P]+e]=H,S[c]&X||(v.value=b(v.value,k[c])),++P>=o));)h=t(r[P]);i()}for(;E<O;)W[m[E]=H]=g[E++],i();if(H>E)for(E=0;E<e;++E)U[E]=m[U[E]];c=C.indexOf(V),H>1?(V=a,Y=u):(!H&&Q&&(H=1,W=[{key:null,value:M()}]),1===H?(V=s,Y=f):(V=d,Y=d),U=null),C[c]=V}function e(){if(H>1){for(var t=H,r=W,n=w(t,t),e=0,o=0;e<j;++e)S[e]&&(n[U[o]=U[e]]=1,++o);for(W=[],H=0,e=0;e<t;++e)n[e]&&(n[e]=H++,W.push(r[e]));if(H>1)for(var e=0;e<o;++e)U[e]=n[U[e]];else U=null;C[C.indexOf(V)]=H>1?(Y=u,V=a):1===H?(Y=f,V=s):Y=V=d}else if(1===H){if(Q)return;for(var e=0;e<j;++e)if(S[e])return;W=[],H=0,C[C.indexOf(V)]=V=Y=d}}function a(t,r,n){if(t!==Z&&!K){var e,o,i,a;for(e=0,i=r.length;e<i;++e)S[o=r[e]]&X||(a=W[U[o]],a.value=B(a.value,k[o]));for(e=0,i=n.length;e<i;++e)(S[o=n[e]]&X)===t&&(a=W[U[o]],a.value=q(a.value,k[o]))}}function s(t,r,n){if(t!==Z&&!K){var e,o,i,a=W[0];for(e=0,i=r.length;e<i;++e)S[o=r[e]]&X||(a.value=B(a.value,k[o]));for(e=0,i=n.length;e<i;++e)(S[o=n[e]]&X)===t&&(a.value=q(a.value,k[o]))}}function u(){var t,r;for(t=0;t<H;++t)W[t].value=N();for(t=0;t<j;++t)S[t]&X||(r=W[U[t]],r.value=B(r.value,k[t]))}function f(){var t,r=W[0];for(r.value=N(),t=0;t<j;++t)S[t]&X||(r.value=B(r.value,k[t]))}function c(){return K&&(Y(),K=!1),W}function l(t){var r=G(c(),0,W.length,t);return I.sort(r,0,r.length)}function p(t,r,n){return B=t,q=r,N=n,K=!0,F}function h(){return p(y,g,v)}function M(t){return p(m(t),b(t),v)}function O(t){function r(r){return t(r.value)}return G=i(r),I=o(r),F}function E(){return O(r)}function P(){return H}function A(){var t=C.indexOf(V);return t>=0&&C.splice(t,1),t=tt.indexOf(n),t>=0&&tt.splice(t,1),t=_.indexOf(e),t>=0&&_.splice(t,1),F}var F={top:l,all:c,reduce:p,reduceCount:h,reduceSum:M,order:O,orderNatural:E,size:P,dispose:A,remove:A};rt.push(F);var W,U,G,I,B,q,N,z=8,J=x(z),H=0,V=d,Y=d,K=!0,Q=t===d;return arguments.length<1&&(t=r),C.push(V),tt.push(n),_.push(e),n(D,R,0,j),h().orderNatural()}function z(){var t=N(d),r=t.all;return delete t.all,delete t.top,delete t.order,delete t.orderNatural,delete t.size,t.value=function(){return r()[0].value},t}function J(){rt.forEach(function(t){t.dispose()});var t=F.indexOf(e);return t>=0&&F.splice(t,1),t=F.indexOf(a),t>=0&&F.splice(t,1),t=_.indexOf(u),t>=0&&_.splice(t,1),P&=X,U()}var D,R,H,V,Y,K={filter:c,filterExact:E,filterRange:W,filterFunction:G,filterAll:U,top:B,bottom:q,group:N,groupAll:z,dispose:J,remove:J},Z=~P&-~P,X=~Z,Q=s(function(t){return H[t]}),$=h,tt=[],rt=[],nt=0,et=0;return F.unshift(e),F.push(a),_.push(u),P|=Z,(A>=32?!Z:P&-(1<<A))&&(S=L(S,A<<=1)),e(k,0,j),a(k,0,j),K}function u(){function t(t,r){var n;if(!h)for(n=r;n<j;++n)S[n]||(u=f(u,k[n]))}function r(t,r,n){var e,o,i;if(!h){for(e=0,i=r.length;e<i;++e)S[o=r[e]]||(u=f(u,k[o]));for(e=0,i=n.length;e<i;++e)S[o=n[e]]===t&&(u=c(u,k[o]))}}function n(){var t;for(u=l(),t=0;t<j;++t)S[t]||(u=f(u,k[t]))}function e(t,r,n){return f=t,c=r,l=n,h=!0,p}function o(){return e(y,g,v)}function i(t){return e(m(t),b(t),v)}function a(){return h&&(n(),h=!1),u}function s(){var n=C.indexOf(r);return n>=0&&C.splice(n),n=F.indexOf(t),n>=0&&F.splice(n),p}var u,f,c,l,p={reduce:e,reduceCount:o,reduceSum:i,value:a,dispose:s,remove:s},h=!0;return C.push(r),F.push(t),t(k,0,j),o()}function f(){return j}var c={add:t,remove:e,dimension:a,groupAll:u,size:f},k=[],j=0,P=0,A=8,S=E(0),C=[],F=[],_=[];return arguments.length?t(arguments[0]):c}function w(t,r){return(r<257?E:r<65537?P:A)(t)}function M(t){for(var r=w(t,t),n=-1;++n<t;)r[n]=n;return r}function x(t){return 8===t?256:16===t?65536:4294967296}k.version="1.3.12",k.permute=n;var O=k.bisect=e(r);O.by=e,(k.heap=o(r)).by=o,(k.heapselect=i(r)).by=i,(k.insertionsort=a(r)).by=a,(k.quicksort=s(r)).by=s;var j=32,E=u,P=u,A=u,T=f,L=c;"undefined"!=typeof Uint8Array&&(E=function(t){return new Uint8Array(t)},P=function(t){return new Uint16Array(t)},A=function(t){return new Uint32Array(t)},T=function(t,r){if(t.length>=r)return t;var n=new t.constructor(r);return n.set(t),n},L=function(t,r){var n;switch(r){case 16:n=P(t.length);break;case 32:n=A(t.length);break;default:throw new Error("invalid array width!")}return n.set(t),n}),t.crossfilter=k}(void 0!==n&&n||this)},{}],22:[function(t,r,n){r.exports=t("./crossfilter").crossfilter},{"./crossfilter":21}],23:[function(t,r,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=t("topojson-client"),o=t("topojson-server"),i=t("topojson-simplify");Object.keys(e).forEach(function(t){n[t]=e[t]}),Object.keys(o).forEach(function(t){n[t]=o[t]}),Object.keys(i).forEach(function(t){n[t]=i[t]})},{"topojson-client":24,"topojson-server":25,"topojson-simplify":26}],24:[function(r,n,e){!function(r,o){"object"==typeof e&&void 0!==n?o(e):"function"==typeof t&&t.amd?t(["exports"],o):o(r.topojson=r.topojson||{})}(this,function(t){"use strict";function r(t,r){var e=r.id,o=r.bbox,i=null==r.properties?{}:r.properties,a=n(t,r);return null==e&&null==o?{type:"Feature",properties:i,geometry:a}:null==o?{type:"Feature",id:e,properties:i,geometry:a}:{type:"Feature",id:e,bbox:o,properties:i,geometry:a}}function n(t,r){function n(t,r){r.length&&r.pop();for(var n=l[t<0?~t:t],e=0,o=n.length;e<o;++e)r.push(f(n[e],e));t<0&&c(r,o)}function e(t){return f(t)}function o(t){for(var r=[],e=0,o=t.length;e<o;++e)n(t[e],r);return r.length<2&&r.push(r[0]),r}function i(t){for(var r=o(t);r.length<4;)r.push(r[0]);return r}function a(t){return t.map(i)}function s(t){var r,n=t.type;switch(n){case"GeometryCollection":return{type:n,geometries:t.geometries.map(s)};case"Point":r=e(t.coordinates);break;case"MultiPoint":r=t.coordinates.map(e);break;case"LineString":r=o(t.arcs);break;case"MultiLineString":r=t.arcs.map(o);break;case"Polygon":r=a(t.arcs);break;case"MultiPolygon":r=t.arcs.map(a);break;default:return null}return{type:n,coordinates:r}}var f=u(t.transform),l=t.arcs;return s(r)}function e(t,r,n){var e,i,a;if(arguments.length>1)e=o(t,r,n);else for(i=0,e=new Array(a=t.arcs.length);i<a;++i)e[i]=i;return{type:"MultiLineString",arcs:p(t,e)}}function o(t,r,n){function e(t){var r=t<0?~t:t;(c[r]||(c[r]=[])).push({i:t,g:u})}function o(t){t.forEach(e)}function i(t){t.forEach(o)}function a(t){t.forEach(i)}function s(t){switch(u=t,t.type){
case"GeometryCollection":t.geometries.forEach(s);break;case"LineString":o(t.arcs);break;case"MultiLineString":case"Polygon":i(t.arcs);break;case"MultiPolygon":a(t.arcs)}}var u,f=[],c=[];return s(r),c.forEach(null==n?function(t){f.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&f.push(t[0].i)}),f}function i(t){for(var r,n=-1,e=t.length,o=t[e-1],i=0;++n<e;)r=o,o=t[n],i+=r[0]*o[1]-r[1]*o[0];return Math.abs(i)}function a(t,r){function e(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"Polygon":o(t.arcs);break;case"MultiPolygon":t.arcs.forEach(o)}}function o(t){t.forEach(function(r){r.forEach(function(r){(s[r=r<0?~r:r]||(s[r]=[])).push(t)})}),u.push(t)}function a(r){return i(n(t,{type:"Polygon",arcs:[r]}).coordinates[0])}var s={},u=[],f=[];return r.forEach(e),u.forEach(function(t){if(!t._){var r=[],n=[t];for(t._=1,f.push(r);t=n.pop();)r.push(t),t.forEach(function(t){t.forEach(function(t){s[t<0?~t:t].forEach(function(t){t._||(t._=1,n.push(t))})})})}}),u.forEach(function(t){delete t._}),{type:"MultiPolygon",arcs:f.map(function(r){var n,e=[];if(r.forEach(function(t){t.forEach(function(t){t.forEach(function(t){s[t<0?~t:t].length<2&&e.push(t)})})}),e=p(t,e),(n=e.length)>1)for(var o,i,u=1,f=a(e[0]);u<n;++u)(o=a(e[u]))>f&&(i=e[0],e[0]=e[u],e[u]=i,f=o);return e})}}var s=function(t){return t},u=function(t){if(null==t)return s;var r,n,e=t.scale[0],o=t.scale[1],i=t.translate[0],a=t.translate[1];return function(t,s){s||(r=n=0);var u=2,f=t.length,c=new Array(f);for(c[0]=(r+=t[0])*e+i,c[1]=(n+=t[1])*o+a;u<f;)c[u]=t[u],++u;return c}},f=function(t){function r(t){t=o(t),t[0]<i&&(i=t[0]),t[0]>s&&(s=t[0]),t[1]<a&&(a=t[1]),t[1]>f&&(f=t[1])}function n(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(n);break;case"Point":r(t.coordinates);break;case"MultiPoint":t.coordinates.forEach(r)}}var e,o=u(t.transform),i=1/0,a=i,s=-i,f=-i;t.arcs.forEach(function(t){for(var r,n=-1,e=t.length;++n<e;)r=o(t[n],n),r[0]<i&&(i=r[0]),r[0]>s&&(s=r[0]),r[1]<a&&(a=r[1]),r[1]>f&&(f=r[1])});for(e in t.objects)n(t.objects[e]);return[i,a,s,f]},c=function(t,r){for(var n,e=t.length,o=e-r;o<--e;)n=t[o],t[o++]=t[e],t[e]=n},l=function(t,n){return"GeometryCollection"===n.type?{type:"FeatureCollection",features:n.geometries.map(function(n){return r(t,n)})}:r(t,n)},p=function(t,r){function n(r){var n,e=t.arcs[r<0?~r:r],o=e[0];return t.transform?(n=[0,0],e.forEach(function(t){n[0]+=t[0],n[1]+=t[1]})):n=e[e.length-1],r<0?[n,o]:[o,n]}function e(t,r){for(var n in t){var e=t[n];delete r[e.start],delete e.start,delete e.end,e.forEach(function(t){o[t<0?~t:t]=1}),s.push(e)}}var o={},i={},a={},s=[],u=-1;return r.forEach(function(n,e){var o,i=t.arcs[n<0?~n:n];i.length<3&&!i[1][0]&&!i[1][1]&&(o=r[++u],r[u]=n,r[e]=o)}),r.forEach(function(t){var r,e,o=n(t),s=o[0],u=o[1];if(r=a[s])if(delete a[r.end],r.push(t),r.end=u,e=i[u]){delete i[e.start];var f=e===r?r:r.concat(e);i[f.start=r.start]=a[f.end=e.end]=f}else i[r.start]=a[r.end]=r;else if(r=i[u])if(delete i[r.start],r.unshift(t),r.start=s,e=a[s]){delete a[e.end];var c=e===r?r:e.concat(r);i[c.start=e.start]=a[c.end=r.end]=c}else i[r.start]=a[r.end]=r;else r=[t],i[r.start=s]=a[r.end=u]=r}),e(a,i),e(i,a),r.forEach(function(t){o[t<0?~t:t]||s.push([t])}),s},h=function(t){return n(t,e.apply(this,arguments))},d=function(t){return n(t,a.apply(this,arguments))},v=function(t,r){for(var n=0,e=t.length;n<e;){var o=n+e>>>1;t[o]<r?n=o+1:e=o}return n},y=function(t){function r(t,r){t.forEach(function(t){t<0&&(t=~t);var n=o[t];n?n.push(r):o[t]=[r]})}function n(t,n){t.forEach(function(t){r(t,n)})}function e(t,r){"GeometryCollection"===t.type?t.geometries.forEach(function(t){e(t,r)}):t.type in a&&a[t.type](t.arcs,r)}var o={},i=t.map(function(){return[]}),a={LineString:r,MultiLineString:n,Polygon:n,MultiPolygon:function(t,r){t.forEach(function(t){n(t,r)})}};t.forEach(e);for(var s in o)for(var u=o[s],f=u.length,c=0;c<f;++c)for(var l=c+1;l<f;++l){var p,h=u[c],d=u[l];(p=i[h])[s=v(p,d)]!==d&&p.splice(s,0,d),(p=i[d])[s=v(p,h)]!==h&&p.splice(s,0,h)}return i},g=function(t){if(null==t)return s;var r,n,e=t.scale[0],o=t.scale[1],i=t.translate[0],a=t.translate[1];return function(t,s){s||(r=n=0);var u=2,f=t.length,c=new Array(f),l=Math.round((t[0]-i)/e),p=Math.round((t[1]-a)/o);for(c[0]=l-r,r=l,c[1]=p-n,n=p;u<f;)c[u]=t[u],++u;return c}},m=function(t,r){function n(t){return h(t)}function e(t){var r;switch(t.type){case"GeometryCollection":r={type:"GeometryCollection",geometries:t.geometries.map(e)};break;case"Point":r={type:"Point",coordinates:n(t.coordinates)};break;case"MultiPoint":r={type:"MultiPoint",coordinates:t.coordinates.map(n)};break;default:return t}return null!=t.id&&(r.id=t.id),null!=t.bbox&&(r.bbox=t.bbox),null!=t.properties&&(r.properties=t.properties),r}function o(t){var r,n=0,e=1,o=t.length,i=new Array(o);for(i[0]=h(t[0],0);++n<o;)((r=h(t[n],n))[0]||r[1])&&(i[e++]=r);return 1===e&&(i[e++]=[0,0]),i.length=e,i}if(t.transform)throw new Error("already quantized");if(r&&r.scale)l=t.bbox;else{if(!((i=Math.floor(r))>=2))throw new Error("n must be ≥2");l=t.bbox||f(t);var i,a=l[0],s=l[1],u=l[2],c=l[3];r={scale:[u-a?(u-a)/(i-1):1,c-s?(c-s)/(i-1):1],translate:[a,s]}}var l,p,h=g(r),d=t.objects,v={};for(p in d)v[p]=e(d[p]);return{type:"Topology",bbox:l,transform:r,objects:v,arcs:t.arcs.map(o)}};t.bbox=f,t.feature=l,t.mesh=h,t.meshArcs=e,t.merge=d,t.mergeArcs=a,t.neighbors=y,t.quantize=m,t.transform=u,t.untransform=g,Object.defineProperty(t,"__esModule",{value:!0})})},{}],25:[function(r,n,e){!function(r,o){"object"==typeof e&&void 0!==n?o(e):"function"==typeof t&&t.amd?t(["exports"],o):o(r.topojson=r.topojson||{})}(this,function(t){"use strict";function r(t,r,e,o){n(t,r,e),n(t,r,r+o),n(t,r+o,e)}function n(t,r,n){for(var e,o=r+(n---r>>1);r<o;++r,--n)e=t[r],t[r]=t[n],t[n]=e}function e(t){return null==t?{type:null}:("FeatureCollection"===t.type?o:"Feature"===t.type?i:a)(t)}function o(t){var r={type:"GeometryCollection",geometries:t.features.map(i)};return null!=t.bbox&&(r.bbox=t.bbox),r}function i(t){var r,n=a(t.geometry);null!=t.id&&(n.id=t.id),null!=t.bbox&&(n.bbox=t.bbox);for(r in t.properties){n.properties=t.properties;break}return n}function a(t){if(null==t)return{type:null};var r="GeometryCollection"===t.type?{type:"GeometryCollection",geometries:t.geometries.map(a)}:"Point"===t.type||"MultiPoint"===t.type?{type:t.type,coordinates:t.coordinates}:{type:t.type,arcs:t.coordinates};return null!=t.bbox&&(r.bbox=t.bbox),r}function s(t){var r,n=t[0],e=t[1];return e<n&&(r=n,n=e,e=r),n+31*e}function u(t,r){var n,e=t[0],o=t[1],i=r[0],a=r[1];return o<e&&(n=e,e=o,o=n),a<i&&(n=i,i=a,a=n),e===i&&o===a}var f=function(t){function r(t){null!=t&&f.hasOwnProperty(t.type)&&f[t.type](t)}function n(t){var r=t[0],n=t[1];r<i&&(i=r),r>s&&(s=r),n<a&&(a=n),n>u&&(u=n)}function e(t){t.forEach(n)}function o(t){t.forEach(e)}var i=1/0,a=1/0,s=-1/0,u=-1/0,f={GeometryCollection:function(t){t.geometries.forEach(r)},Point:function(t){n(t.coordinates)},MultiPoint:function(t){t.coordinates.forEach(n)},LineString:function(t){e(t.arcs)},MultiLineString:function(t){t.arcs.forEach(e)},Polygon:function(t){t.arcs.forEach(e)},MultiPolygon:function(t){t.arcs.forEach(o)}};for(var c in t)r(t[c]);return s>=i&&u>=a?[i,a,s,u]:void 0},c=function(t,r,n,e,o){function i(e){for(var i=r(e)&f,a=u[i],s=0;a!=o;){if(n(a,e))return!0;if(++s>=t)throw new Error("full hashset");a=u[i=i+1&f]}return u[i]=e,!0}function a(e){for(var i=r(e)&f,a=u[i],s=0;a!=o;){if(n(a,e))return!0;if(++s>=t)break;a=u[i=i+1&f]}return!1}function s(){for(var t=[],r=0,n=u.length;r<n;++r){var e=u[r];e!=o&&t.push(e)}return t}3===arguments.length&&(e=Array,o=null);for(var u=new e(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),f=t-1,c=0;c<t;++c)u[c]=o;return{add:i,has:a,values:s}},l=function(t,r,n,e,o,i){function a(e,i){for(var a=r(e)&p,s=c[a],u=0;s!=o;){if(n(s,e))return l[a]=i;if(++u>=t)throw new Error("full hashmap");s=c[a=a+1&p]}return c[a]=e,l[a]=i,i}function s(e,i){for(var a=r(e)&p,s=c[a],u=0;s!=o;){if(n(s,e))return l[a];if(++u>=t)throw new Error("full hashmap");s=c[a=a+1&p]}return c[a]=e,l[a]=i,i}function u(e,i){for(var a=r(e)&p,s=c[a],u=0;s!=o;){if(n(s,e))return l[a];if(++u>=t)break;s=c[a=a+1&p]}return i}function f(){for(var t=[],r=0,n=c.length;r<n;++r){var e=c[r];e!=o&&t.push(e)}return t}3===arguments.length&&(e=i=Array,o=null);for(var c=new e(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),l=new i(t),p=t-1,h=0;h<t;++h)c[h]=o;return{set:a,maybeSet:s,get:u,keys:f}},p=function(t,r){return t[0]===r[0]&&t[1]===r[1]},h=new ArrayBuffer(16),d=new Float64Array(h),v=new Uint32Array(h),y=function(t){d[0]=t[0],d[1]=t[1];var r=v[0]^v[1];return 2147483647&(r=r<<5^r>>7^v[2]^v[3])},g=function(t){function r(t,r,n,e){if(g[n]!==t){g[n]=t;var o=m[n];if(o>=0){var i=b[n];o===r&&i===e||o===e&&i===r||(++w,k[n]=1)}else m[n]=r,b[n]=e}}function n(t){return y(f[t])}function e(t,r){return p(f[t],f[r])}var o,i,a,s,u,f=t.coordinates,h=t.lines,d=t.rings,v=function(){for(var t=l(1.4*f.length,n,e,Int32Array,-1,Int32Array),r=new Int32Array(f.length),o=0,i=f.length;o<i;++o)r[o]=t.maybeSet(o,o);return r}(),g=new Int32Array(f.length),m=new Int32Array(f.length),b=new Int32Array(f.length),k=new Int8Array(f.length),w=0;for(o=0,i=f.length;o<i;++o)g[o]=m[o]=b[o]=-1;for(o=0,i=h.length;o<i;++o){var M=h[o],x=M[0],O=M[1];for(s=v[x],u=v[++x],++w,k[s]=1;++x<=O;)r(o,a=s,s=u,u=v[x]);++w,k[u]=1}for(o=0,i=f.length;o<i;++o)g[o]=-1;for(o=0,i=d.length;o<i;++o){var j=d[o],E=j[0]+1,P=j[1];for(a=v[P-1],s=v[E-1],u=v[E],r(o,a,s,u);++E<=P;)r(o,a=s,s=u,u=v[E])}g=m=b=null;var A,T=c(1.4*w,y,p);for(o=0,i=f.length;o<i;++o)k[A=v[o]]&&T.add(f[A]);return T},m=function(t){var n,e,o,i=g(t),a=t.coordinates,s=t.lines,u=t.rings;for(e=0,o=s.length;e<o;++e)for(var f=s[e],c=f[0],l=f[1];++c<l;)i.has(a[c])&&(n={0:c,1:f[1]},f[1]=c,f=f.next=n);for(e=0,o=u.length;e<o;++e)for(var p=u[e],h=p[0],d=h,v=p[1],y=i.has(a[h]);++d<v;)i.has(a[d])&&(y?(n={0:d,1:p[1]},p[1]=d,p=p.next=n):(r(a,h,v,v-d),a[v]=a[h],y=!0,d=h));return t},b=function(t){function r(t){var r,o,i,a,s,u,f,c;if(i=m.get(r=h[t[0]]))for(f=0,c=i.length;f<c;++f)if(a=i[f],n(a,t))return t[0]=a[0],void(t[1]=a[1]);if(s=m.get(o=h[t[1]]))for(f=0,c=s.length;f<c;++f)if(u=s[f],e(u,t))return t[1]=u[0],void(t[0]=u[1]);i?i.push(t):m.set(r,[t]),s?s.push(t):m.set(o,[t]),b.push(t)}function n(t,r){var n=t[0],e=r[0],o=t[1];if(n-o!=e-r[1])return!1;for(;n<=o;++n,++e)if(!p(h[n],h[e]))return!1;return!0}function e(t,r){var n=t[0],e=r[0],o=t[1],i=r[1];if(n-o!=e-i)return!1;for(;n<=o;++n,--i)if(!p(h[n],h[i]))return!1;return!0}function o(t,r){var n=t[0],e=r[0],o=t[1],i=r[1],s=o-n;if(s!==i-e)return!1;for(var u=a(t),f=a(r),c=0;c<s;++c)if(!p(h[n+(c+u)%s],h[e+(c+f)%s]))return!1;return!0}function i(t,r){var n=t[0],e=r[0],o=t[1],i=r[1],s=o-n;if(s!==i-e)return!1;for(var u=a(t),f=s-a(r),c=0;c<s;++c)if(!p(h[n+(c+u)%s],h[i-(c+f)%s]))return!1;return!0}function a(t){for(var r=t[0],n=t[1],e=r,o=e,i=h[e];++e<n;){var a=h[e];(a[0]<i[0]||a[0]===i[0]&&a[1]<i[1])&&(o=e,i=a)}return o-r}var s,u,f,c,h=t.coordinates,d=t.lines,v=t.rings,g=d.length+v.length;for(delete t.lines,delete t.rings,f=0,c=d.length;f<c;++f)for(s=d[f];s=s.next;)++g;for(f=0,c=v.length;f<c;++f)for(u=v[f];u=u.next;)++g;var m=l(2*g*1.4,y,p),b=t.arcs=[];for(f=0,c=d.length;f<c;++f){s=d[f];do{r(s)}while(s=s.next)}for(f=0,c=v.length;f<c;++f)if(u=v[f],u.next)do{r(u)}while(u=u.next);else!function(t){var r,n,e,s,u;if(n=m.get(r=h[t[0]]))for(s=0,u=n.length;s<u;++s){if(e=n[s],o(e,t))return t[0]=e[0],void(t[1]=e[1]);if(i(e,t))return t[0]=e[1],void(t[1]=e[0])}if(n=m.get(r=h[t[0]+a(t)]))for(s=0,u=n.length;s<u;++s){if(e=n[s],o(e,t))return t[0]=e[0],void(t[1]=e[1]);if(i(e,t))return t[0]=e[1],void(t[1]=e[0])}n?n.push(t):m.set(r,[t]),b.push(t)}(u);return t},k=function(t){for(var r=-1,n=t.length;++r<n;){for(var e,o,i=t[r],a=0,s=1,u=i.length,f=i[0],c=f[0],l=f[1];++a<u;)f=i[a],e=f[0],o=f[1],e===c&&o===l||(i[s++]=[e-c,o-l],c=e,l=o);1===s&&(i[s++]=[0,0]),i.length=s}return t},w=function(t){function r(t){t&&f.hasOwnProperty(t.type)&&f[t.type](t)}function n(t){for(var r=0,n=t.length;r<n;++r)u[++i]=t[r];var e={0:i-n+1,1:i};return a.push(e),e}function e(t){for(var r=0,n=t.length;r<n;++r)u[++i]=t[r];var e={0:i-n+1,1:i};return s.push(e),e}function o(t){return t.map(e)}var i=-1,a=[],s=[],u=[],f={GeometryCollection:function(t){t.geometries.forEach(r)},LineString:function(t){t.arcs=n(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(n)},Polygon:function(t){t.arcs=t.arcs.map(e)},MultiPolygon:function(t){t.arcs=t.arcs.map(o)}};for(var c in t)r(t[c]);return{type:"Topology",coordinates:u,lines:a,rings:s,objects:t}},M=function(t){var r,n={};for(r in t)n[r]=e(t[r]);return n},x=function(t,r,n){function e(t){return[Math.round((t[0]-f)*h),Math.round((t[1]-c)*d)]}function o(t,r){for(var n,e,o,i,a,s=-1,u=0,l=t.length,p=new Array(l);++s<l;)n=t[s],i=Math.round((n[0]-f)*h),a=Math.round((n[1]-c)*d),i===e&&a===o||(p[u++]=[e=i,o=a]);for(p.length=u;u<r;)u=p.push([p[0][0],p[0][1]]);return p}function i(t){return o(t,2)}function a(t){return o(t,4)}function s(t){return t.map(a)}function u(t){null!=t&&v.hasOwnProperty(t.type)&&v[t.type](t)}var f=r[0],c=r[1],l=r[2],p=r[3],h=l-f?(n-1)/(l-f):1,d=p-c?(n-1)/(p-c):1,v={GeometryCollection:function(t){t.geometries.forEach(u)},Point:function(t){t.coordinates=e(t.coordinates)},MultiPoint:function(t){t.coordinates=t.coordinates.map(e)},LineString:function(t){t.arcs=i(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(i)},Polygon:function(t){t.arcs=s(t.arcs)},MultiPolygon:function(t){t.arcs=t.arcs.map(s)}};for(var y in t)u(t[y]);return{scale:[1/h,1/d],translate:[f,c]}},O=function(t,r){function n(t){t&&d.hasOwnProperty(t.type)&&d[t.type](t)}function e(t){var r=[];do{var n=h.get(t);r.push(t[0]<t[1]?n:~n)}while(t=t.next);return r}function o(t){return t.map(e)}var i=f(t=M(t)),a=r>0&&i&&x(t,i,r),c=b(m(w(t))),p=c.coordinates,h=l(1.4*c.arcs.length,s,u);t=c.objects,c.bbox=i,c.arcs=c.arcs.map(function(t,r){return h.set(t,r),p.slice(t[0],t[1]+1)}),delete c.coordinates,p=null;var d={GeometryCollection:function(t){t.geometries.forEach(n)},LineString:function(t){t.arcs=e(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(e)},Polygon:function(t){t.arcs=t.arcs.map(e)},MultiPolygon:function(t){t.arcs=t.arcs.map(o)}};for(var v in t)n(t[v]);return a&&(c.transform=a,c.arcs=k(c.arcs)),c};t.topology=O,Object.defineProperty(t,"__esModule",{value:!0})})},{}],26:[function(r,n,e){!function(o,i){"object"==typeof e&&void 0!==n?i(e,r("topojson-client")):"function"==typeof t&&t.amd?t(["exports","topojson-client"],i):i(o.topojson=o.topojson||{},o.topojson)}(this,function(t,r){"use strict";function n(){return!0}function e(t){return t}function o(t){return null!=t.type}function i(t){var r=t[0],n=t[1],e=t[2];return Math.abs((r[0]-e[0])*(n[1]-r[1])-(r[0]-n[0])*(e[1]-r[1]))/2}function a(t){for(var r,n=-1,e=t.length,o=t[e-1],i=0;++n<e;)r=o,o=t[n],i+=r[0]*o[1]-r[1]*o[0];return Math.abs(i)/2}function s(t,r){return t[1][2]-r[1][2]}function u(t){return[t[0],t[1],0]}function f(t,r){if(n=t.length){if((r=+r)<=0||n<2)return t[0];if(r>=1)return t[n-1];var n,e=(n-1)*r,o=Math.floor(e),i=t[o];return i+(t[o+1]-i)*(e-o)}}function c(t,r){return r-t}function l(t,r){for(var n,e,o,i=0,a=t.length,s=0,u=t[r?i++:a-1],f=u[0]*E,c=u[1]*E/2+j,l=T(c),p=L(c);i<a;++i){u=t[i],n=f,f=u[0]*E,c=u[1]*E/2+j,e=l,l=T(c),o=p,p=L(c);var h=f-n,d=h>=0?1:-1,v=d*h,y=o*p,g=e*l+y*T(v),m=y*d*L(v);s+=A(m,g)}return s}function p(t,r){var n=l(t,!0);return r&&(n*=-1),2*(n<0?O+n:n)}function h(t){return 2*P(l(t,!1))}var d=function(t){function r(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(r);break;case"LineString":e(t.arcs);break;case"MultiLineString":case"Polygon":t.arcs.forEach(e);break;case"MultiPolygon":t.arcs.forEach(o)}}function n(t){t<0&&(t=~t),y[t]||(y[t]=1,++g)}function e(t){t.forEach(n)}function o(t){t.forEach(e)}function i(t){var r;switch(t.type){case"GeometryCollection":r={type:"GeometryCollection",geometries:t.geometries.map(i)};break;case"LineString":r={type:"LineString",arcs:s(t.arcs)};break;case"MultiLineString":r={type:"MultiLineString",arcs:t.arcs.map(s)};break;case"Polygon":r={type:"Polygon",arcs:t.arcs.map(s)};break;case"MultiPolygon":r={type:"MultiPolygon",arcs:t.arcs.map(u)};break;default:return t}return null!=t.id&&(r.id=t.id),null!=t.bbox&&(r.bbox=t.bbox),null!=t.properties&&(r.properties=t.properties),r}function a(t){return t<0?~y[~t]:y[t]}function s(t){return t.map(a)}function u(t){return t.map(s)}var f,c,l=t.objects,p={},h=t.arcs,d=h.length,v=-1,y=new Array(d),g=0,m=-1;for(c in l)r(l[c]);for(f=new Array(g);++v<d;)y[v]&&(y[v]=++m,f[m]=h[v]);for(c in l)p[c]=i(l[c]);return{type:"Topology",bbox:t.bbox,transform:t.transform,objects:p,arcs:f}},v=function(t,r){function i(t){var r,n;switch(t.type){case"Polygon":n=a(t.arcs),r=n?{type:"Polygon",arcs:n}:{type:null};break;case"MultiPolygon":n=t.arcs.map(a).filter(e),r=n.length?{type:"MultiPolygon",arcs:n}:{type:null};break;case"GeometryCollection":n=t.geometries.map(i).filter(o),r=n.length?{type:"GeometryCollection",geometries:n}:{type:null};break;default:return t}return null!=t.id&&(r.id=t.id),null!=t.bbox&&(r.bbox=t.bbox),null!=t.properties&&(r.properties=t.properties),r}function a(t){return t.length&&s(t[0])?[t[0]].concat(t.slice(1).filter(u)):null}function s(t){return r(t,!1)}function u(t){return r(t,!0)}var f,c=t.objects,l={};null==r&&(r=n);for(f in c)l[f]=i(c[f]);return d({type:"Topology",bbox:t.bbox,transform:t.transform,objects:l,arcs:t.arcs})},y=function(t){function r(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(r);break;case"Polygon":n(t.arcs);break;case"MultiPolygon":t.arcs.forEach(n)}}function n(t){for(var r=0,n=t.length;r<n;++r,++i)for(var e=t[r],a=0,s=e.length;a<s;++a){var u=e[a];u<0&&(u=~u);var f=o[u];null==f?o[u]=i:f!==i&&(o[u]=-1)}}var e,o=new Array(t.arcs.length),i=0;for(e in t.objects)r(t.objects[e]);return function(t){for(var r,n=0,e=t.length;n<e;++n)if(-1===o[(r=t[n])<0?~r:r])return!0;return!1}},g=function(t,n,e){return n=null==n?Number.MIN_VALUE:+n,null==e&&(e=a),function(o,i){return e(r.feature(t,{type:"Polygon",arcs:[o]}).geometry.coordinates[0],i)>=n}},m=function(t,r,n){var e=y(t),o=g(t,r,n);return function(t,r){return e(t,r)||o(t,r)}},b=function(){function t(t,r){for(;r>0;){var n=(r+1>>1)-1,o=e[n];if(s(t,o)>=0)break;e[o._=r]=o,e[t._=r=n]=t}}function r(t,r){for(;;){var n=r+1<<1,i=n-1,a=r,u=e[a];if(i<o&&s(e[i],u)<0&&(u=e[a=i]),n<o&&s(e[n],u)<0&&(u=e[a=n]),a===r)break;e[u._=r]=u,e[t._=r=a]=t}}var n={},e=[],o=0;return n.push=function(r){return t(e[r._=o]=r,o++),o},n.pop=function(){if(!(o<=0)){var t,n=e[0];return--o>0&&(t=e[o],r(e[t._=0]=t,0)),n}},n.remove=function(n){var i,a=n._;if(e[a]===n)return a!==--o&&(i=e[o],(s(i,n)<0?t:r)(e[i._=a]=i,a)),a},n},k=function(t,n){function e(t){a.remove(t),t[1][2]=n(t),a.push(t)}var o=t.transform?r.transform(t.transform):u,a=b();null==n&&(n=i);var s=t.arcs.map(function(t){var r,i,s,u=[],f=0;for(t=t.map(o),i=1,s=t.length-1;i<s;++i)r=[t[i-1],t[i],t[i+1]],r[1][2]=n(r),u.push(r),a.push(r);for(t[0][2]=t[s][2]=1/0,i=0,s=u.length;i<s;++i)r=u[i],r.previous=u[i-1],r.next=u[i+1];for(;r=a.pop();){var c=r.previous,l=r.next;r[1][2]<f?r[1][2]=f:f=r[1][2],c&&(c.next=l,c[2]=r[2],e(c)),l&&(l.previous=c,l[0]=r[0],e(l))}return t});return{type:"Topology",bbox:t.bbox,objects:t.objects,arcs:s}},w=function(t,r){var n=[];return t.arcs.forEach(function(t){t.forEach(function(t){isFinite(t[2])&&n.push(t[2])})}),n.length&&f(n.sort(c),r)},M=function(t,r){r=null==r?Number.MIN_VALUE:+r;var n=t.arcs.map(function(t){for(var n,e=-1,o=0,i=t.length,a=new Array(i);++e<i;)(n=t[e])[2]>=r&&(a[o++]=[n[0],n[1]]);return a.length=o,a});return{type:"Topology",transform:t.transform,bbox:t.bbox,objects:t.objects,arcs:n}},x=Math.PI,O=2*x,j=x/4,E=x/180,P=Math.abs,A=Math.atan2,T=Math.cos,L=Math.sin;t.filter=v,t.filterAttached=y,t.filterAttachedWeight=m,t.filterWeight=g,t.planarRingArea=a,t.planarTriangleArea=i,t.presimplify=k,t.quantile=w,t.simplify=M,t.sphericalRingArea=p,t.sphericalTriangleArea=h,Object.defineProperty(t,"__esModule",{value:!0})})},{"topojson-client":24}]},{},[12])(12)});